{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    // "config":{
    //     "legend": {"columns": 2}
    // },
    "data": {
        "url": "https://raw.githubusercontent.com/car121201/FIT3179/main/Assignment2/Smoking_Rank.csv"
    },
    "title": {
        "text": "Total Smokers Rank by Country Across Continents ( 1980 to 2000 )",
        "color": "navy",
        "fontSize": 22,
        "align": "center",
        "anchor": "middle",
        "dy": -1,
        "baseline": "middle"
    },
    "width": 1000,
    "height": 800,
    "params": [
        {
            "name": "Starting_Year",
            "value": 1980,
            "bind": { "input": "range", "min": 1980, "max": 1990, "step": 10 }
        },
        {
            "name": "Continent_selection",
            "bind": {
                "input": "select",
                "options": ["North America", "South America", "Europe", "Africa", "Asia", "Oceania"],
                "labels": ["North America", "South America", "Europe", "Africa", "Asia", "Oceania"],
                "name": "Continent: "
            },
            "value": "North America"
        }
    ],
    "transform": [
        {
            "filter": "Continent_selection == null || datum.Continent == Continent_selection"
        },
        {
            "sort": [
                { "field": "Total_Smokers", "order": "descending" }
            ],
            "window": [
                {
                    "op": "rank",
                    "as": "rank"
                }
            ],
            "groupby": ["Year", "Continent"]
        },
        { "filter": "datum.Year >= Starting_Year && datum.Year <= Starting_Year + 10" }
    ],
    "encoding": {
        "x": {
            "field": "Year",
            "type": "ordinal",
            "axis": { "labelAngle": 0, "labelFontSize": 12, "titleFontSize": 14 },
            "title": "Year"
        },
        "y": {
            "field": "rank",
            "type": "ordinal",
            "sort": "ascending",
            "axis": {
                "labelAngle": 0,
                "labelFontSize": 12,
                "tickMinStep": 1,
                "titleFontSize": 14
            },
            "title": "Total Smokers ranking"
        },
        "order": {
            "field": "Year", 
            "type": "quantitative"
            },

        "color": {
            "field": "Category", 
            "type": "nominal", 
            "scale": {
                // "scheme": "category20"
                "range":  
                ["#0D47A1", "#1A237E", "#01579B", "#0D47A1", "#0A0E6A","#004D40", "#1B5E20", "#33691E", "#AFB42B", "#827717", "#FFA000", "#FF6F00", "#E65100", "#BF360C", "#5D4037", "#3E2723", "#455A64", "#37474F", "#263238", "#607D8B","#004D40", "#1B5E20", "#33691E", "#AFB42B", "#827717", "#FFA000", "#FF6F00", "#E65100", "#BF360C", "#5D4037"]

                    }
                }

,
        
        "tooltip": [ 
            { "field": "Country", "title": "Country" },
            { "field": "Total_Smokers", "title": "Total Smokers" },
            { "field": "rank", "title": "Rank"}
        ]
    },
    "layer": [
        {
            "mark": {"type": "line", "interpolate": "monotone"},
            "encoding": {
                "opacity": {
                    "condition": {
                    "param": "country_legend",
                    "field": "Country",
                    "value": 1
                    },
                    "value": 0.1
                    },
                
              "color": { 
                // "condition":  {
                //     "param": "country_legend", 
                //     "empty": false, 
                //     "value": "black" 
                //     },
                    "field": "Country"
                    },
              "size":{
                "condition":  {
                    "param": "country_legend", 
                    "empty": false, 
                    "value": 4
                    },
                "value": 1
        }
            }
        },
        {
            "params": [
                { 
                    "name": "country_legend", 
                    "select": {
                        "type": "point", 
                        "on": "click", 
                        "fields": ["Country"] 
                        },
                    "bind": "legend"
                }
            ],
            "mark": {
                "type": "tick", 
                "thickness": 5, 
                "orient": "horizontal"
                },
            "encoding": {
                "y": {
                    "field": "rank"
                    },
                "opacity": {
                    "condition": {
                    "param": "country_legend",
                    "field": "Country",
                    "value": 1
                    },
                    "value": 0.2
                    },
                
                "color": {
                    // "condition":  {
                    //     "param": "country_legend", 
                    //     "empty": false,
                    //     "value": "black" 
                    //     },
                    "field": "Country"
                }
            }
        }
    ]
}
